## following indices in the averages variable
for(i in 1:n_sim){
averages[i] <-mean(rexp(n, lambda))
}
hist(averages, main = " Histogram of simulated averages", xlab = "Average")
qqnorm(averages)
qqline(averages)
qnorm(rnorm(1000))
qqnorm(rnorm(1000))
x <- rnorm(1000)
qqnorm(x)
qqline(x)
set.seed(5868)
# Set the parameters for the simulation
n_sim <- 1000; n <-40; lambda <-.2
averages <- rep(NA, n_sim)
for(i in 1:n_sim){
averages[i] <-mean(rexp(n, lambda))
}
hist(averages, main = " Histogram of simulated averages", xlab = "Average")
abline(v = 1/lambda)
abline(v = 1/lambda, col="red")
hist(averages, main = " Histogram of simulated averages", xlab = "Average")
abline(v = 1/lambda, col="red") # Theoretical mean
abline(v = mean(averages), col - "blue")
abline(v = mean(averages), col = "blue")
set.seed(5868)
n_sim <- 1000; n <-40; lambda <-.2
# Create empty vector for averages
averages <- rep(NA, n_sim)
for(i in 1:n_sim){averages[i] <-mean(rexp(n, lambda))}
hist(averages, main = " Histogram of simulated averages", xlab = "Average")
abline(v = 1/lambda, col="red") # Theoretical mean
abline(v = mean(averages), col = "blue") #Empirical mean
set.seed(558)
n_sim <- 1000; n <-40; lambda <-.2
averages <- rep(NA, n_sim)
for(i in 1:n_sim){averages[i] <-mean(rexp(n, lambda))}
hist(averages, main = " Histogram of simulated averages", xlab = "Average")
abline(v = 1/lambda, col="red") # Theoretical mean
abline(v = mean(averages), col = "blue") #Empirical mean
sample_mean <- mean(averages)
qqnorm(averages)
qqline(averages)
qqline(averages, col = "red")
variance <- (averages-sum(averages)/length(averages))
variance <- sum(((averages-sum(averages))^2)/length(averages))
(averages-sum(averages))^2
average
averages
variance <- sum(((averages-mean(averages))^2)/length(averages))
sd(averages)*40
(1/lambda)/sqrt(40)
ac <- rep(NA, 40)
for(i in 1:n_sim){ac[i] <-mean(rexp(n, lambda))}
hist(ac)
setwd("~/R/Gawrony")
wokal_ziemia_tabela <- data.frame(id = 1:108)
wokal_ziemia_tabela$wokal_zewnatrz <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_ziemia_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnątrz[i,2:31]))
x <- x[index]
wokal_ziemia_tabela[i,2] <- mean(x, na.rm = T)
}
# Tabela z sumowanym wokalizacjami (odpowiadające sobie komórki są sumowane (x+1))
wokal_drzewo_wszystko <- data.frame(id = 1:108, wokal_drzewo[,2:31] + wokal_drzewo[,32:61])
wokal_drzewo_wszystko[45:108,2:31] <- wokal_drzewo_wszystko[45:108,2:31] + wokal_drzewo[45:108,62:91]
wokal_drzewo_roznice <- t(apply(as.matrix(wokal_drzewo_wszystko[,2:31]), 1, diff))
wokal_drzewo_roznice <- data.frame(id = 1:108, wokal_drzewo_roznice)
## Sprawdzenie róźnic pomiędzy ilością wokalizacji przy wokalizaji z zewnątrz
## lub jej braku
wokal_drzewo_tabela <- data.frame(id = 1:108)
wokal_drzewo_tabela$wokal_zewnatrz <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnątrz[i,2:31]))
x <- x[index]
wokal_drzewo_tabela[i,2] <- mean(x, na.rm = T)
}
### Liczymy średnią ilośc wokalizacji przy braku wokalizacji z zewnatrz
wokal_drzewo_tabela$wokal_z_zewnatrz_brak <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnątrz[i,2:31]))
x <- x[!index]
wokal_drzewo_tabela[i,3] <- mean(x, na.rm = T)
}
boxplot(wokal_drzewo_tabela$wokal_zewnatrz, wokal_drzewo_tabela$wokal_z_zewnatrz_brak)
# Tabela z sumowanym wokalizacjami (odpowiadające sobie komórki są sumowane (x+1))
wokal_ziemia_wszystko <- data.frame(id = 1:108, wokal_ziemia[,2:31] + wokal_ziemia[,32:61])
wokal_ziemia_wszystko[45:108,2:31] <- wokal_ziemia_wszystko[45:108,2:31] + wokal_ziemia[45:108,62:91]
wokal_ziemia_roznice <- t(apply(as.matrix(wokal_ziemia_wszystko[,2:31]), 1, diff))
wokal_ziemia_roznice <- data.frame(id = 1:108, wokal_ziemia_roznice)
## Sprawdzenie róźnic pomiędzy ilością wokalizacji przy wokalizaji z zewnątrz
## lub jej braku
wokal_ziemia_tabela <- data.frame(id = 1:108)
wokal_ziemia_tabela$wokal_zewnatrz <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_ziemia_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnątrz[i,2:31]))
x <- x[index]
wokal_ziemia_tabela[i,4] <- mean(x, na.rm = T)
}
### Liczymy średnią ilośc wokalizacji przy braku wokalizacji z zewnatrz
wokal_ziemia_tabela$wokal_z_zewnatrz_brak <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_ziemia_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnątrz[i,2:31]))
x <- x[!index]
wokal_ziemia_tabela[i,5] <- mean(x, na.rm = T)
}
boxplot(wokal_ziemia_tabela$wokal_zewnatrz, wokal_ziemia_tabela$wokal_z_zewnatrz_brak)
wokal_drzewo_wszystko <- data.frame(id = 1:108, wokal_drzewo[,2:31] + wokal_drzewo[,32:61])
source("wczytywanie_danych.R")
# Tabela z sumowanym wokalizacjami (odpowiadające sobie komórki są sumowane (x+1))
wokal_drzewo_wszystko <- data.frame(id = 1:108, wokal_drzewo[,2:31] + wokal_drzewo[,32:61])
wokal_drzewo_wszystko[45:108,2:31] <- wokal_drzewo_wszystko[45:108,2:31] + wokal_drzewo[45:108,62:91]
wokal_drzewo_roznice <- t(apply(as.matrix(wokal_drzewo_wszystko[,2:31]), 1, diff))
wokal_drzewo_roznice <- data.frame(id = 1:108, wokal_drzewo_roznice)
## Sprawdzenie róźnic pomiędzy ilością wokalizacji przy wokalizaji z zewnątrz
## lub jej braku
wokal_drzewo_tabela <- data.frame(id = 1:108)
wokal_drzewo_tabela$wokal_zewnatrz <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnątrz[i,2:31]))
x <- x[index]
wokal_drzewo_tabela[i,2] <- mean(x, na.rm = T)
}
### Liczymy średnią ilośc wokalizacji przy braku wokalizacji z zewnatrz
wokal_drzewo_tabela$wokal_z_zewnatrz_brak <- vector(mode = "numeric", 108)
wokal_drzewo_tabela$wokal_z_zewnatrz_brak <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnątrz_brak[i,2:31]))
x <- x[!index]
wokal_drzewo_tabela[i,3] <- mean(x, na.rm = T)
}
wokal_drzewo_wszystko <- data.frame(id = 1:108, wokal_drzewo[,2:31] + wokal_drzewo[,32:61])
wokal_drzewo_wszystko[45:108,2:31] <- wokal_drzewo_wszystko[45:108,2:31] + wokal_drzewo[45:108,62:91]
wokal_drzewo_roznice <- t(apply(as.matrix(wokal_drzewo_wszystko[,2:31]), 1, diff))
wokal_drzewo_roznice <- data.frame(id = 1:108, wokal_drzewo_roznice)
wokal_drzewo_tabela <- data.frame(id = 1:108)
wokal_drzewo_tabela$wokal_zewnatrz <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnątrz[i,2:31]))
x <- x[index]
wokal_drzewo_tabela[i,2] <- mean(x, na.rm = T)
}
source("wczytywanie_danych.R")
View(wokalizacja_z_zewnatrz)
wokal_drzewo_tabela <- data.frame(id = 1:108)
wokal_drzewo_tabela$wokal_zewnatrz <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnatrz[i,2:31]))
x <- x[index]
wokal_drzewo_tabela[i,2] <- mean(x, na.rm = T)
}
wokal_drzewo_tabela$wokal_z_zewnatrz_brak <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnatrz[i,2:31]))
x <- x[!index]
wokal_drzewo_tabela[i,3] <- mean(x, na.rm = T)
}
boxplot(wokal_drzewo_tabela$wokal_zewnatrz, wokal_drzewo_tabela$wokal_z_zewnatrz_brak)
wokal_ziemia_wszystko <- data.frame(id = 1:108, wokal_ziemia[,2:31] + wokal_ziemia[,32:61])
wokal_ziemia_wszystko[45:108,2:31] <- wokal_ziemia_wszystko[45:108,2:31] + wokal_ziemia[45:108,62:91]
wokal_ziemia_roznice <- t(apply(as.matrix(wokal_ziemia_wszystko[,2:31]), 1, diff))
wokal_ziemia_roznice <- data.frame(id = 1:108, wokal_ziemia_roznice)
wokal_ziemia_tabela <- data.frame(id = 1:108)
wokal_ziemia_tabela$wokal_zewnatrz <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_ziemia_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnatrz[i,2:31]))
x <- x[index]
wokal_ziemia_tabela[i,4] <- mean(x, na.rm = T)
}
wokal_drzewo_wszystko <- data.frame(id = 1:108, wokal_drzewo[,2:31] + wokal_drzewo[,32:61])
wokal_drzewo_wszystko[45:108,2:31] <- wokal_drzewo_wszystko[45:108,2:31] + wokal_drzewo[45:108,62:91]
wokal_drzewo_roznice <- t(apply(as.matrix(wokal_drzewo_wszystko[,2:31]), 1, diff))
wokal_drzewo_roznice <- data.frame(id = 1:108, wokal_drzewo_roznice)
## Sprawdzenie róźnic pomiędzy ilością wokalizacji przy wokalizaji z zewnątrz
## lub jej braku
wokal_drzewo_tabela <- data.frame(id = 1:108)
wokal_drzewo_tabela$wokal_zewnatrz <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnatrz[i,2:31]))
x <- x[index]
wokal_drzewo_tabela[i,2] <- mean(x, na.rm = T)
}
### Liczymy średnią ilośc wokalizacji przy braku wokalizacji z zewnatrz
wokal_drzewo_tabela$wokal_z_zewnatrz_brak <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnatrz[i,2:31]))
x <- x[!index]
wokal_drzewo_tabela[i,3] <- mean(x, na.rm = T)
}
boxplot(wokal_drzewo_tabela$wokal_zewnatrz, wokal_drzewo_tabela$wokal_z_zewnatrz_brak)
wokal_ziemia_tabela <- data.frame(id = 1:108)
wokal_ziemia_tabela$wokal_zewnatrz <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_ziemia_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnatrz[i,2:31]))
x <- x[index]
wokal_ziemia_tabela[i,2] <- mean(x, na.rm = T)
}
wokal_ziemia_tabela$wokal_z_zewnatrz_brak <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_ziemia_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnatrz[i,2:31]))
x <- x[!index]
wokal_ziemia_tabela[i,3] <- mean(x, na.rm = T)
}
boxplot(wokal_ziemia_tabela$wokal_zewnatrz, wokal_ziemia_tabela$wokal_z_zewnatrz_brak)
View(n_drzewo)
View(n_ziemia)
View(n_ziemia)
n_ogolem <- data.frame(id = 1:108, n_ziemia[,2:31]+n_drzewo[,2,31])
n_ogolem
View(n_ogolem)
n_ogolem$max <- apply(n_oglem[,2:31], 1, max)
n_ogolem$max <- apply(n_ogolem[,2:31], 1, max, na.rm  =T)
n_ogolem$max
n_ogolem$mean <- apply(n_ogolem[,2:31], 1, mean, na.rm  =T)
n_ogolem$mean
wokal_drzewo_wszystko <- data.frame(id = 1:108, wokal_drzewo[,2:31] + wokal_drzewo[,32:61])
wokal_ziemia_wszystko <- data.frame(id = 1:108, wokal_ziemia[,2:31] + wokal_ziemia[,32:61])
wokal_drzewo_wszystko <- data.frame(id = 1:108, wokal_drzewo[,2:31] + wokal_drzewo[,32:61])
wokal_ziemia_wszystko <- data.frame(id = 1:108, wokal_ziemia[,2:31] + wokal_ziemia[,32:61])
wokal_wszystko <- data.frame(id=1:108, wokal_ziemia_wszystko[,2:31]+
wokal_drzewo_wszystko=[,2:31]
wokal_wszystko <- data.frame(id=1:108, wokal_ziemia_wszystko[,2:31]+
wokal_drzewo_wszystko[,2:31]
)
View(wokal_wszystko)
wokal_wszysztko$max <- apply(wokal_wszystko[,2:31], 1, max, na.rm = T)
wokal_wszysztko$mean <- apply(wokal_wszystko[,2:31], 1, mwan, na.rm = T)
wokal_wszystko$max <- apply(wokal_wszystko[,2:31], 1, max, na.rm = T)
wokal_wszystko$mean <- apply(wokal_wszystko[,2:31], 1, mwan, na.rm = T)
wokal_wszystko$mean <- apply(wokal_wszystko[,2:31], 1, mean, na.rm = T)
plot(n_ogólem$max, wokal_wszystko$max)
plot(n_ogolem$max, wokal_wszystko$max)
cor(n_ogolem$max, wokal_wszystko$max)
plot(n_ogolem$mean, wokal_wszystko$mean)
cor(n_ogolem$mean, wokal_wszystko$mean)
cor.test(n_ogolem$max, wokal_wszystko$max)
plot(n_ogolem$max, wokal_wszystko$max)
plot(n_ogolem$mean, wokal_wszystko$mean)
cor.test(n_ogolem$mean, wokal_wszystko$mean)
source("wczytywanie_danych.R")
# Tabela z sumowanym wokalizacjami (odpowiadające sobie komórki są sumowane (x+1))
wokal_drzewo_wszystko <- data.frame(id = 1:108, wokal_drzewo[,2:31] + wokal_drzewo[,32:61])
wokal_drzewo_wszystko[45:108,2:31] <- wokal_drzewo_wszystko[45:108,2:31] + wokal_drzewo[45:108,62:91]
wokal_drzewo_roznice <- t(apply(as.matrix(wokal_drzewo_wszystko[,2:31]), 1, diff))
wokal_drzewo_roznice <- data.frame(id = 1:108, wokal_drzewo_roznice)
## Sprawdzenie róźnic pomiędzy ilością wokalizacji przy wokalizaji z zewnątrz
## lub jej braku
wokal_drzewo_tabela <- data.frame(id = 1:108)
wokal_drzewo_tabela$wokal_zewnatrz <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnatrz[i,2:31]))
x <- x[index]
wokal_drzewo_tabela[i,2] <- mean(x, na.rm = T)
}
### Liczymy średnią ilośc wokalizacji przy braku wokalizacji z zewnatrz
wokal_drzewo_tabela$wokal_z_zewnatrz_brak <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnatrz[i,2:31]))
x <- x[!index]
wokal_drzewo_tabela[i,3] <- mean(x, na.rm = T)
}
boxplot(wokal_drzewo_tabela$wokal_zewnatrz, wokal_drzewo_tabela$wokal_z_zewnatrz_brak)
# Tabela z sumowanym wokalizacjami (odpowiadające sobie komórki są sumowane (x+1))
wokal_ziemia_wszystko <- data.frame(id = 1:108, wokal_ziemia[,2:31] + wokal_ziemia[,32:61])
wokal_ziemia_wszystko[45:108,2:31] <- wokal_ziemia_wszystko[45:108,2:31] + wokal_ziemia[45:108,62:91]
wokal_ziemia_roznice <- t(apply(as.matrix(wokal_ziemia_wszystko[,2:31]), 1, diff))
wokal_ziemia_roznice <- data.frame(id = 1:108, wokal_ziemia_roznice)
## Sprawdzenie róźnic pomiędzy ilością wokalizacji przy wokalizaji z zewnątrz
## lub jej braku
wokal_ziemia_tabela <- data.frame(id = 1:108)
wokal_ziemia_tabela$wokal_zewnatrz <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_ziemia_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnatrz[i,2:31]))
x <- x[index]
wokal_ziemia_tabela[i,2] <- mean(x, na.rm = T)
}
### Liczymy średnią ilośc wokalizacji przy braku wokalizacji z zewnatrz
wokal_ziemia_tabela$wokal_z_zewnatrz_brak <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_ziemia_wszystko[i,2:31])
index <- as.logical(unlist(wokalizacja_z_zewnatrz[i,2:31]))
x <- x[!index]
wokal_ziemia_tabela[i,3] <- mean(x, na.rm = T)
}
boxplot(wokal_ziemia_tabela$wokal_zewnatrz, wokal_ziemia_tabela$wokal_z_zewnatrz_brak)
source("wczytywanie_danych.R")
## Sumujemy wokalizacje
sumy_drzewo <- apply(wokal_drzewo[,2:91], 1, sum, na.rm = T)
sumy_ziemia <- apply(wokal_ziemia[,2:91], 1, sum, na.rm = T)
plot(podstawowe$temperatura, sumy_ziemia)
plot(podstawowe$temperatura, sumy_drzewo)
plot(podstawowe$wilgotnosc, sumy_ziemia)
plot(podstawowe$wilgotnosc, sumy_drzewo)
plot(podstawowe$cisnienie, sumy_ziemia)
plot(podstawowe$cisnienie, sumy_drzewo)
source("wczytywanie_danych.R")
## HIPOTEZA: Więcej wokalizacji na drzewie
## Ogólnie
drzewo <- apply(wokal_drzewo[,-1], 1, sum, na.rm=T)
ziemia <- apply(wokal_ziemia[,-1], 1, sum, na.rm=T)
lot <- apply(wokal_lot[,-1], 1, sum, na.rm=T)
boxplot(drzewo, ziemia, lot)
wilcox.test(drzewo, ziemia)
source("wczytywanie_danych.R")
wokal_drzewo_wszystko <- data.frame(id = 1:108, wokal_drzewo[,2:31] + wokal_drzewo[,32:61])
wokal_drzewo_wszystko[45:108,2:31] <- wokal_drzewo_wszystko[45:108,2:31] + wokal_drzewo[45:108,62:91]
wokal_drzewo_roznice <- t(apply(as.matrix(wokal_drzewo_wszystko[,2:31]), 1, diff))
wokal_drzewo_roznice <- data.frame(id = 1:108, wokal_drzewo_roznice)
czlowiek_roznice <- matrix(rep(as.numeric(NA), 3132), nrow = 108, ncol = 29)
for(i in 1:108){
x <- unlist(czlowiek[i,2:31])
diffy <- NULL
for(n in 1:length(x)-1){
wynik <-ifelse(!x[n+1]==x[n], x[n+1]-x[n],
ifelse(x[n]==0, 0, 2))
diffy <- append(diffy, wynik)
}
czlowiek_roznice[i,] <- diffy
}
czlowiek_roznice <- data.frame(1:108, czlowiek_roznice)
names(czlowiek_roznice) <- names(wokal_drzewo_roznice)
x <- as.matrix(czlowiek_roznice[,2:30])
indexy <- as.vector(x) == 1
roznice <- as.vector(as.matrix(wokal_drzewo_roznice[,2:30]))
czlowiek_1 <- roznice[indexy]
## Gdy człowiek pozostaje
indexy <- as.vector(x) == 2
roznice <- as.vector(as.matrix(wokal_drzewo_roznice[,2:30]))
czlowiek_2 <- roznice[indexy]
## Gdy człowiek znika
indexy <- as.vector(x) == -1
roznice <- as.vector(as.matrix(wokal_drzewo_roznice[,2:30]))
czlowiek_minus1 <- roznice[indexy]
## Gdy człowiek jest nieobecny
indexy <- as.vector(x) == 0
roznice <- as.vector(as.matrix(wokal_drzewo_roznice[,2:30]))
czlowiek_0 <- roznice[indexy]
jpeg("plots/czlowiek_zmiany_drzewo_drzewo.jpg", 1000,1000)
boxplot(czlowiek_0, czlowiek_1, czlowiek_2, czlowiek_minus1)
dev.off()
boxplot(czlowiek_0, czlowiek_1, czlowiek_2, czlowiek_minus1)
## STARE ALE DOBRE - po prostu interwały z zakłóceniami i bez
# Tworzę tabelę, w której będą się zawieraly podsumowania dotyczące wokalu
# w oparciu o obecność różnych zakłóceń
### Liczymy średnią ilośc wokalizacji przy obecności człowieka
wokal_drzewo_tabela <- data.frame(id = 1:108)
wokal_drzewo_tabela$czlowiek <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(czlowiek[i,2:31]))
x <- x[index]
wokal_drzewo_tabela[i,2] <- mean(x, na.rm = T)
}
### Liczymy średnią ilośc wokalizacji przy braku obecności człowieka
wokal_drzewo_tabela$czlowiek_brak <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(czlowiek[i,2:31]))
x <- x[!index]
wokal_drzewo_tabela[i,3] <- mean(x, na.rm = T)
}
boxplot(wokal_drzewo_tabela$czlowiek_brak, wokal_drzewo_tabela$czlowiek)
View(n_ogolem)
## Intensywność wokalizacji, a obecność osobnika z pokarmem
wokal_drzewo_wszystko <- data.frame(id = 1:108, wokal_drzewo[,2:31] + wokal_drzewo[,32:61])
wokal_drzewo_wszystko[45:108,2:31] <- wokal_drzewo_wszystko[45:108,2:31] + wokal_drzewo[45:108,62:91]
# Tworzę tabelę, w której będą się zawieraly podsumowania dotyczące wokalu
# w oparciu o obecność osonika z pokarmem
### Liczymy średnią ilośc wokalizacji przy obecności osobnika z pokarmem
wokal_drzewo_tabela <- data.frame(id = 1:108)
wokal_drzewo_tabela$pokarm <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(pokarm[i,2:31]))
x <- x[index]
wokal_drzewo_tabela[i,2] <- mean(x, na.rm = T)
}
### Liczymy średnią ilośc wokalizacji przy braku pokarmu
wokal_drzewo_tabela$pokarm_brak <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_drzewo_wszystko[i,2:31])
index <- as.logical(unlist(pokarm[i,2:31]))
x <- x[!index]
wokal_drzewo_tabela[i,3] <- mean(x, na.rm = T)
}
boxplot(wokal_drzewo_tabela$pokarm_brak, wokal_drzewo_tabela$pokarm_brak)
wokal_ziemia_wszystko <- data.frame(id = 1:108, wokal_ziemia[,2:31] + wokal_ziemia[,32:61])
wokal_ziemia_wszystko[45:108,2:31] <- wokal_ziemia_wszystko[45:108,2:31] + wokal_ziemia[45:108,62:91]
# Tworzę tabelę, w której będą się zawieraly podsumowania dotyczące wokalu
# w oparciu o obecność osonika z pokarmem
### Liczymy średnią ilośc wokalizacji przy obecności osobnika z pokarmem
wokal_ziemia_tabela <- data.frame(id = 1:108)
wokal_ziemia_tabela$pokarm <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_ziemia_wszystko[i,2:31])
index <- as.logical(unlist(pokarm[i,2:31]))
x <- x[index]
wokal_ziemia_tabela[i,2] <- mean(x, na.rm = T)
}
### Liczymy średnią ilośc wokalizacji przy braku pokarmu
wokal_ziemia_tabela$pokarm_brak <- vector(mode = "numeric", 108)
for(i in 1:108){
x <- unlist(wokal_ziemia_wszystko[i,2:31])
index <- as.logical(unlist(pokarm[i,2:31]))
x <- x[!index]
wokal_ziemia_tabela[i,3] <- mean(x, na.rm = T)
}
boxplot(wokal_ziemia_tabela$pokarm_brak, wokal_ziemia_tabela$pokarm_brak)
setwd("~/R/gacki_analiza")
jablow <- read.csv2("input/jablow_calosc.csv", as.is = TRUE)
kody <- jablow$Event_V
kody
source("functions/observation_split.R")
source("functions/count_instances.R")
source("functions/u_remove.R")
library(dplyr)
library(lubridate)
jablow <- read.csv2("input/jablow_calosc.csv", as.is = TRUE)
jablow$Date_time <- dmy_hms(paste(jablow$Data, jablow$Time))
jablow <- u_remove(jablow)
jablow_pociete <- observation_split(jablow)
jablow <- read.csv2("input/jablow_calosc.csv", as.is = TRUE)
## Zmieniam daty na format R - patrz lubridate
jablow$Date_time <- dmy_hms(paste(jablow$Data, jablow$Time))
jablow <- u_remove(jablow, slash = T)
jablow_pociete2 <- observation_split(jablow)
zdarzenia <- count_instances(jablow_pociete, characters)
characters <-c("a","l","t","r","p","c","d","f","n","e", "u")
zdarzenia <- count_instances(jablow_pociete, characters)
sum(jablow$Quantity)
source("functions/u_remove.R")
jablow <- read.csv2("input/jablow_calosc.csv", as.is = TRUE)
## Zmieniam daty na format R - patrz lubridate
jablow$Date_time <- dmy_hms(paste(jablow$Data, jablow$Time))
## Usuwamy dane zawierające oberwacje niepełne (u), bez podmianki wewnętrzych
# elementów na "/", kontroluje parametr slash
jablow <- u_remove(jablow, slash = F)
## Rozbijamy obserwacje z wieloma nietoperzami na pojedyncze obserwacje
jablow_pociete <- observation_split(jablow)
rm(jablow)
characters <-c("a","l","t","r","p","c","d","f","n","e", "u")
zdarzenia <- count_instances(jablow_pociete, characters)
# Łączę tabele ze zdarzeniami i tabelę wejściową
jablow_zdarzenia <- cbind(jablow_pociete, zdarzenia)
jablow_zdarzenia <- tbl_df(jablow_zdarzenia)
## Zapisuje dane do tabeli zewnętrznej
write.csv(jablow_zdarzenia, "output/jablow_zdarzenia")
## Takie se powiedzmy eksploracje ----
# Grupuję po sezonach
jablow_zdarzenia <- group_by(jablow_zdarzenia, Season)
# Liczę ilość pościgów i ilość zdarzeń, a następniew wyliczam średnią ilośc
# pościgów na sezon
summary <- summarise(jablow_zdarzenia, sum_p =sum(p, na.rm = TRUE), n = length(p))
summary <- mutate(summary, mean_p = sum_p/n)
summary
krajanow <- read.csv2("input/krajanow_calosc.csv", as.is = TRUE)
## Zmieniam daty na format R - patrz lubridate
krajanow$Date_time <- dmy_hms(paste(krajanow$Data, krajanow$Time))
krajanow <- u_remove(krajanow)
View(krajanow)
krajanow <- read.csv2("input/krajanow_calosc.csv", as.is = TRUE)
krajanow$Date_time <- dmy_hms(paste(krajanow$Data, krajanow$Time))
## Usuwamy dane zawierające oberwacje niepełne (u) - to jeszcze eksploracja
krajanow <- u_remove(krajanow)
## Rozbijamy obserwacje z wieloma nietoperzami na pojedyncze obserwacje
krajanow_pociete <- observation_split(krajanow)
rm(krajanow)
characters <-c("a","l","t","r","p","c","d","f","n","e", "u")
zdarzenia <- count_instances(krajanow_pociete, characters)
krajanow_zdarzenia <- cbind(krajanow_pociete, zdarzenia)
# Zamieniam na wygodniejszy format - patrz dplyr
krajanow_zdarzenia <- tbl_df(krajanow_zdarzenia)
write.csv(krajanow_zdarzenia, "output/krajanow_zdarzenia")
krajanow_zdarzenia <- group_by(krajanow_zdarzenia, Season)
summary <- summarise(krajanow_zdarzenia, sum_p =sum(p, na.rm = TRUE), n = length(p))
summary <- mutate(summary, mean_p = sum_p/n)
summary
summary
summary_jablow <- summarise(jablow_zdarzenia, sum_p =sum(p, na.rm = TRUE), n = length(p))
summary_jablow<- mutate(summary, mean_p = sum_p/n)
summary_jablow <- summarise(jablow_zdarzenia, sum_p =sum(p, na.rm = TRUE), n = length(p))
summary_jablow<- mutate(summary, mean_p = sum_p/n)
summary_krajanow <- summarise(krajanow_zdarzenia, sum_p =sum(p, na.rm = TRUE), n = length(p))
summary_krajanow <- mutate(summary, mean_p = sum_p/n)
summary_jablow
summary_krajanow
summary_jablow<- mutate(summary_jablow, mean_p = sum_p/n)
summary_krajanow <- mutate(summary_krajanow, mean_p = sum_p/n)
summary_krajanow
summary_jablow
summary_jablow <- summarise(jablow_zdarzenia, sum_p =sum(p, na.rm = TRUE), n = length(p))
summary_jablow<- mutate(summary_jablow, mean_p = sum_p/n)
summary_jablow

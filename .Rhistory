setwd("~/R/gacki_analiza")
source("functions/observation_split.R")
source("functions/count_instances.R")
source("functions/u_remove.R")
source("functions/bs_remove.R")
source("functions/get_sun.R")
library(dplyr)
library(lubridate)
library(ggplot2)
# Wczytywanie dancyh o słońcu
sun <- get_sun("input/wschody_zachody_2012.csv")
sun <- tbl_df(sun)
jablow <- read.csv2("input/jablow_calosc.csv", as.is = TRUE)
krajanow <- read.csv2("input/krajanow_calosc.csv", as.is = TRUE)
jablow <- tbl_df(jablow)
krajanow <- tbl_df(krajanow)
calosc <- bind_rows(krajanow, jablow)
rm(jablow)
rm(krajanow)
## Zmieniam daty na format R - patrz lubridate
calosc$Date_time <- dmy_hms(paste(calosc$Data, calosc$Time))
calosc$Date_time <- calosc$Date_time -  minutes(60)
# Ustalamy porę dnia (wieczór/rano)
calosc$godzina <- hour(calosc$Date_time)
calosc$Part_night <- factor(ifelse(calosc$godzina>=12, "wieczor", "rano"))
calosc$Part_night <- relevel(calosc$Part_night, "wieczor")
# Czyścimy tabelę ze zbędnych kolumn
calosc <- select(calosc, Season, Phase, Date_time,Channel, Night, Part_night,
Event_V, Toys, Quantity)
# Dodajemy dane o słońcu
calosc$date <- as.Date(calosc$Date_time)
calosc <- left_join(calosc, sun, by ="date" )
calosc <- mutate(calosc,after_down = Date_time - sunset,
till_dusk = sunrise - Date_time)
calosc$after_down <- minutes(calosc$after_down)
hist_act <- ggplot(x = after_down, data = calosc)
hist_act + geom_hist()
hist_act + geom_histogram()
hist_act <- ggplot(aes(x = after_down, data = calosc)=
hist_act <- ggplot(aes(x = after_down, data = calosc))
hist_act <- ggplot(aes(x = after_down) data = calosc)
hist_act <- ggplot(aes(x = after_down), data = calosc)
hist_act + geom_histogram()
hist_act <- ggplot(calosc, aes(x = after_down))
hist_act + geom_histogram()
hist_act <- ggplot(calosc, aes(x = as.numeric(after_down))
hist_act + geom_histogram()
hist_act <- ggplot(calosc, aes(x = as.numeric(after_down)))
hist_act + geom_histogram()
histogram(as.numeric(calosc$after_down[calosc$Part_night=="wieczor"])/60)
histogram(as.numeric(calosc$till_dusk[calosc$Part_night=="rano"]))
hist_act + geom_histogram() + facet_grid(. ~ Season)
calosc <- mutate(calosc,after_down = Date_time - sunset,
till_dusk = sunrise - Date_time)
histogram(as.numeric(calosc$after_down[calosc$Part_night=="wieczor"])/60)
library(lattice)
histogram(as.numeric(calosc$after_down[calosc$Part_night=="wieczor"])/60)
histogram(as.numeric(calosc$till_dusk[calosc$Part_night=="rano"]))
hist_act <- ggplot(calosc, aes(x = as.numeric(after_down)/60))
hist_act + geom_histogram() + facet_grid(. ~ Season)
hist_act + geom_histogram(binwidth = 5) + facet_grid(. ~ Season)
?geom_histogram
hist_act <- ggplot(calosc[calosc$Part_night == "wieczor",], aes(x = as.numeric(after_down)/60))
hist_act + geom_histogram(binwidth = 5) + facet_grid(. ~ Season)
hist_act <- ggplot(calosc[calosc$Part_night == "rano",], aes(x = as.numeric(after_down)/60))
hist_act + geom_histogram(binwidth = 5) + facet_grid(. ~ Season)
hist_act <- ggplot(calosc[calosc$Part_night == "rano",], aes(x = as.numeric(till_dusk)/60))
hist_act + geom_histogram(binwidth = 5) + facet_grid(. ~ Season)
hist_act + geom_histogram() + facet_grid(. ~ Season)
